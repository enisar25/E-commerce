{
  "info": {
    "name": "E-commerce API",
    "_postman_id": "c5a6e2fa-0000-4000-8000-collection",
    "description": "Postman collection to exercise core flows (auth, cart, checkout, payment, orders). Set the environment variables before running.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Signup",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"John Doe\",\n  \"email\": \"user@example.com\",\n  \"password\": \"Passw0rd!\"\n}"
            },
            "url": "{{baseUrl}}/api/auth/signup"
          }
        },
        {
          "name": "Login",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"Passw0rd!\"\n}"
            },
            "url": "{{baseUrl}}/api/auth/login"
          }
        },
        {
          "name": "Me",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/auth/me"
          }
        }
      ]
    },
    {
      "name": "Products",
      "item": [
        {
          "name": "List Products",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/product"
          }
        },
        {
          "name": "Get Product",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/product/{{productId}}"
          }
        }
      ]
    },
    {
      "name": "Cart",
      "item": [
        {
          "name": "Get Cart",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/cart"
          }
        },
        {
          "name": "Add to Cart",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"productId\": \"{{productId}}\",\n  \"quantity\": 1\n}"
            },
            "url": "{{baseUrl}}/api/cart"
          }
        }
      ]
    },
    {
      "name": "Checkout & Payment",
      "item": [
        {
          "name": "Create Checkout (Stripe)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"shippingAddress\": {\n    \"street\": \"123 Main St\",\n    \"city\": \"New York\",\n    \"state\": \"NY\",\n    \"zipCode\": \"10001\",\n    \"country\": \"USA\"\n  },\n  \"paymentMethod\": \"STRIPE\",\n  \"shippingCost\": 10,\n  \"successUrl\": \"https://example.com/success\",\n  \"cancelUrl\": \"https://example.com/cancel\"\n}"
            },
            "url": "{{baseUrl}}/api/checkout"
          }
        },
        {
          "name": "Create Checkout (COD)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"shippingAddress\": {\n    \"street\": \"123 Main St\",\n    \"city\": \"New York\",\n    \"state\": \"NY\",\n    \"zipCode\": \"10001\",\n    \"country\": \"USA\"\n  },\n  \"paymentMethod\": \"COD\",\n  \"shippingCost\": 10\n}"
            },
            "url": "{{baseUrl}}/api/checkout"
          }
        },
        {
          "name": "Get Payment Intent",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/payment/intent/{{paymentIntentId}}"
          }
        },
        {
          "name": "Confirm Payment (Stripe manual fallback)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/payment/intent/{{paymentIntentId}}/confirm"
          }
        }
      ]
    },
    {
      "name": "Admin Payment",
      "item": [
        {
          "name": "Confirm COD Payment (Admin)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": "{{baseUrl}}/api/payment/admin/cod/{{paymentIntentId}}/confirm"
          }
        },
        {
          "name": "Refund Order (Stripe, Admin)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": "{{baseUrl}}/api/payment/admin/order/{{orderId}}/refund"
          }
        }
      ]
    },
    {
      "name": "Orders",
      "item": [
        {
          "name": "List My Orders",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/order"
          }
        },
        {
          "name": "Get Order",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/order/{{orderId}}"
          }
        }
      ]
    },
    {
      "name": "Webhooks (Stripe)",
      "item": [
        {
          "name": "Stripe Webhook (local testing)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Stripe-Signature",
                "value": "{{stripeSignature}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"payment_intent.succeeded\",\n  \"data\": {\n    \"object\": {\n      \"id\": \"pi_test\",\n      \"status\": \"succeeded\"\n    }\n  }\n}"
            },
            "url": "{{baseUrl}}/api/payment/webhook/stripe"
          }
        }
      ]
    },
    {
      "name": "Brands",
      "item": [
        {
          "name": "List Brands",
          "request": { "method": "GET", "url": "{{baseUrl}}/api/brand" }
        },
        {
          "name": "Get Brand",
          "request": { "method": "GET", "url": "{{baseUrl}}/api/brand/{{brandId}}" }
        },
        {
          "name": "Create Brand (Admin, multipart)",
          "request": {
            "method": "POST",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "name", "value": "Brand X", "type": "text" },
                { "key": "description", "value": "Desc", "type": "text" },
                { "key": "website", "value": "https://brand.com", "type": "text" },
                { "key": "image", "type": "file", "src": "" }
              ]
            },
            "url": "{{baseUrl}}/api/brand"
          }
        },
        {
          "name": "Update Brand (Admin, multipart)",
          "request": {
            "method": "PATCH",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "name", "value": "Brand X2", "type": "text" },
                { "key": "description", "value": "Updated", "type": "text" },
                { "key": "website", "value": "https://brand.com", "type": "text" },
                { "key": "image", "type": "file", "src": "" }
              ]
            },
            "url": "{{baseUrl}}/api/brand/{{brandId}}"
          }
        },
        {
          "name": "Delete Brand (Admin)",
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "url": "{{baseUrl}}/api/brand/{{brandId}}"
          }
        }
      ]
    },
    {
      "name": "Categories",
      "item": [
        {
          "name": "List Categories",
          "request": { "method": "GET", "url": "{{baseUrl}}/api/category" }
        },
        {
          "name": "Get Category",
          "request": { "method": "GET", "url": "{{baseUrl}}/api/category/{{categoryId}}" }
        },
        {
          "name": "Create Category (Admin, multipart)",
          "request": {
            "method": "POST",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "name", "value": "Category A", "type": "text" },
                { "key": "description", "value": "Desc", "type": "text" },
                { "key": "image", "type": "file", "src": "" }
              ]
            },
            "url": "{{baseUrl}}/api/category"
          }
        },
        {
          "name": "Update Category (Admin, multipart)",
          "request": {
            "method": "PATCH",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "name", "value": "Category A2", "type": "text" },
                { "key": "description", "value": "Updated", "type": "text" },
                { "key": "image", "type": "file", "src": "" }
              ]
            },
            "url": "{{baseUrl}}/api/category/{{categoryId}}"
          }
        },
        {
          "name": "Delete Category (Admin)",
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "url": "{{baseUrl}}/api/category/{{categoryId}}"
          }
        }
      ]
    },
    {
      "name": "Products (Admin/Seller)",
      "item": [
        {
          "name": "List Products (filters supported)",
          "request": { "method": "GET", "url": "{{baseUrl}}/api/product" }
        },
        {
          "name": "Create Product (multipart)",
          "request": {
            "method": "POST",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "name", "value": "Product A", "type": "text" },
                { "key": "description", "value": "Desc", "type": "text" },
                { "key": "price", "value": "100", "type": "text" },
                { "key": "discount", "value": "0", "type": "text" },
                { "key": "stock", "value": "10", "type": "text" },
                { "key": "brandId", "value": "{{brandId}}", "type": "text" },
                { "key": "categoryId", "value": "{{categoryId}}", "type": "text" },
                { "key": "images", "type": "file", "src": "" }
              ]
            },
            "url": "{{baseUrl}}/api/product"
          }
        },
        {
          "name": "Update Product (multipart)",
          "request": {
            "method": "PATCH",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "name", "value": "Product A2", "type": "text" },
                { "key": "price", "value": "120", "type": "text" },
                { "key": "discount", "value": "5", "type": "text" },
                { "key": "stock", "value": "8", "type": "text" },
                { "key": "images", "type": "file", "src": "" }
              ]
            },
            "url": "{{baseUrl}}/api/product/{{productId}}"
          }
        },
        {
          "name": "Delete Product (Admin)",
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "url": "{{baseUrl}}/api/product/{{productId}}"
          }
        }
      ]
    },
    {
      "name": "Cart (Full)",
      "item": [
        {
          "name": "Get Cart Summary",
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": "{{baseUrl}}/api/cart/summary"
          }
        },
        {
          "name": "Add to Cart (POST /cart/add)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{\n  \"productId\": \"{{productId}}\",\n  \"quantity\": 1\n}" },
            "url": "{{baseUrl}}/api/cart/add"
          }
        },
        {
          "name": "Update Cart Item Quantity",
          "request": {
            "method": "PATCH",
            "header": [
              { "key": "Authorization", "value": "Bearer {{token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{\n  \"quantity\": 2\n}" },
            "url": "{{baseUrl}}/api/cart/item/{{productId}}"
          }
        },
        {
          "name": "Remove Cart Item",
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": "{{baseUrl}}/api/cart/item/{{productId}}"
          }
        },
        {
          "name": "Clear Cart",
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": "{{baseUrl}}/api/cart/clear"
          }
        },
        {
          "name": "Apply Coupon to Cart",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"code\": \"{{couponCode}}\" }" },
            "url": "{{baseUrl}}/api/cart/apply-coupon"
          }
        },
        {
          "name": "Remove Coupon from Cart",
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": "{{baseUrl}}/api/cart/remove-coupon"
          }
        }
      ]
    },
    {
      "name": "Coupons (Admin/User)",
      "item": [
        {
          "name": "Admin Create Coupon",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": \"SAVE10\",\n  \"discountType\": \"PERCENTAGE\",\n  \"discountValue\": 10,\n  \"usageLimit\": 100,\n  \"validFrom\": \"2024-01-01\",\n  \"validTo\": \"2025-01-01\"\n}"
            },
            "url": "{{baseUrl}}/api/coupon"
          }
        },
        {
          "name": "Admin List Coupons",
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "url": "{{baseUrl}}/api/coupon?page=1&limit=20"
          }
        },
        {
          "name": "Admin Update Coupon",
          "request": {
            "method": "PATCH",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"discountValue\": 15 }" },
            "url": "{{baseUrl}}/api/coupon/{{couponId}}"
          }
        },
        {
          "name": "Admin Delete Coupon",
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "url": "{{baseUrl}}/api/coupon/{{couponId}}"
          }
        },
        {
          "name": "Validate Coupon (User)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"code\": \"{{couponCode}}\" }" },
            "url": "{{baseUrl}}/api/coupon/validate?cartTotal=100"
          }
        }
      ]
    },
    {
      "name": "Favorites",
      "item": [
        {
          "name": "Toggle Favorite",
          "request": {
            "method": "PATCH",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": "{{baseUrl}}/api/favorites/favourite-toggle/{{productId}}"
          }
        }
      ]
    },
    {
      "name": "Orders (Admin)",
      "item": [
        {
          "name": "List Orders (Admin)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "url": "{{baseUrl}}/api/order/admin/all?page=1&limit=20"
          }
        },
        {
          "name": "Update Order Status (Admin)",
          "request": {
            "method": "PATCH",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"status\": \"CONFIRMED\" }" },
            "url": "{{baseUrl}}/api/order/{{orderId}}/status"
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000"
    },
    {
      "key": "token",
      "value": ""
    },
    {
      "key": "adminToken",
      "value": ""
    },
    {
      "key": "productId",
      "value": ""
    },
    {
      "key": "paymentIntentId",
      "value": ""
    },
    {
      "key": "orderId",
      "value": ""
    },
    {
      "key": "stripeSignature",
      "value": ""
    }
  ]
}

